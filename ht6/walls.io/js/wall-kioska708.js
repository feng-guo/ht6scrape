window.templates=window.templates||{},window.templates.checkin_video=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="video-wrapper checkin-video-wrapper">\n  <video loop="loop" class="checkin-video">\n    <source src="'+__e(videoUrl)+'" type="video/mp4" />\n  </video>\n\n  <div class="video-mute-button"></div>\n</div>\n';return __p};
window.templates=window.templates||{},window.templates.highlight_icon=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<svg class="checkin-highlight-icon" x="0px" y="0px" width="41px" height="41px" viewBox="0 0 41 41">\n  <path class="checkin-highlight-icon-badge" d="M0,0v41l20.333-7L41,41V0H0z M26.988,28L20.5,25.104L14.011,28l0.89-6.766l-4.899-4.978l7.038-1.286L20.5,9\n  l3.46,5.971l7.038,1.286L26.1,21.234L26.988,28z"/>\n  <path class="checkin-highlight-icon-star" d="M20.5,9l3.46,5.971l7.038,1.286l-4.899,4.977L26.989,28\n  L20.5,25.104L14.011,28l0.89-6.766l-4.899-4.977l7.038-1.286L20.5,9"/>\n</svg>\n';return __p};
window.templates=window.templates||{},window.templates.message=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="checkin-message-wrapper">\n  <div class="checkin-message">\n    '+(null==(__t=message)?"":__t)+"\n  </div>\n</div>\n";return __p};
window.templates=window.templates||{},window.templates.user=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="checkin-user clearfix">\n  ',userLink?(__p+="\n\n    ",image&&(__p+='\n      <a href="'+(null==(__t=userLink)?"":__t)+'" class="checkin-user-image" target="_blank" style="background-image: url('+(null==(__t=image)?"":__t)+')">\n      </a>\n    '),__p+='\n\n    <div class="checkin-user-name" title="'+__e(combinedName)+'">\n      <a href="'+(null==(__t=userLink)?"":__t)+'" target="_blank">\n        '+(null==(__t=nameParts)?"":__t)+"\n      </a>\n    </div>\n\n  "):(__p+="\n\n    ",image&&(__p+='\n      <div class="checkin-user-image" style="background-image: url('+(null==(__t=image)?"":__t)+')">\n      </div>\n    '),__p+='\n\n    <div class="checkin-user-name" title="'+__e(combinedName)+'">\n      '+(null==(__t=nameParts)?"":__t)+"\n    </div>\n\n  "),__p+="\n\n  ",postLink?__p+='\n    <a href="'+(null==(__t=postLink)?"":__t)+'" class="checkin-timestamp" data-timestamp="'+(null==(__t=externalCreatedTimestamp)?"":__t)+'" target="_blank"></a>\n  ':__p+='\n    <span class="checkin-timestamp" data-timestamp="'+(null==(__t=externalCreatedTimestamp)?"":__t)+'"></span>\n  ',__p+='\n\n  <div class="checkin-type checkin-type-'+(null==(__t=type)?"":__t)+'" title="'+(null==(__t=helpers.getChannelName(type))?"":__t)+'" data-action="show-detail" >\n  </div>\n</div>\n';return __p};
window.templates=window.templates||{},window.templates.user_name_parts=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)hasSeparateNames?__p+='\n  <span class="checkin-user-name-part checkin-user-name-full">'+__e(fullName)+'</span>\n  <span class="checkin-user-name-part checkin-user-name-short">'+__e(shortName)+"</span>\n":__p+="\n  "+__e(combinedName)+"\n",__p+="\n";return __p};
window.templates=window.templates||{},window.templates["detail/container"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="detail-container" data-action="hide-detail">\n  <div class="detail-inner">\n    '+(null==(__t=detailContent)?"":__t)+'\n  </div>\n\n  <div class="detail-loading-indicator-wrapper">\n    <svg class="loading-indicator detail-loading-indicator">\n      <use xlink:href="#app-logo-svg"></use>\n    </svg>\n  </div>\n</div>\n\n<div class="detail-menu" data-action="hide-detail">\n  '+(null==(__t=detailMenuSharing)?"":__t)+'\n\n  <div class="detail-close" data-action="hide-detail"></div>\n</div>\n';return __p};
window.templates=window.templates||{},window.templates["detail/content"]=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="detail-content detail-content-'+(null==(__t=hasImage?"withimage":"withoutimage")?"":__t)+'">\n  '+(null==(__t=postImageElement)?"":__t)+'\n\n  <div class="detail-text-wrapper detail-text-wrapper-'+(null==(__t=network)?"":__t)+'">\n    <div class="detail-network-background detail-network-background-'+(null==(__t=network)?"":__t)+'"></div>\n\n    <div class="detail-text-inner">\n      <div class="detail-text-content">\n        '+(null==(__t=detailUserElement)?"":__t)+'\n\n        <div class="detail-message">\n          <div class="detail-message-inner">'+(null==(__t=message)?"":__t)+'</div>\n        </div>\n      </div>\n\n      <div class="detail-text-extra">\n        '+(null==(__t=detailSharingElement)?"":__t)+"\n      </div>\n    </div>\n  </div>\n</div>\n";return __p};
window.templates=window.templates||{},window.templates["detail/menu_sharing"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="detail-menu-sharing">\n  <button type="button" class="detail-menu-sharing-expander" data-action="show-detail-menu-sharing">'+__e(helpers.translation.__("SHARE_POST"))+'</button>\n\n  <div class="detail-menu-sharing-content">\n    <a href="https://www.facebook.com/sharer/sharer.php?u='+(null==(__t=encodeURIComponent(link))?"":__t)+'" class="detail-menu-sharing-button" data-action="share" data-network="facebook">\n      <i class="fa fa-facebook"></i>\n    </a>\n\n    <a href="https://twitter.com/intent/tweet?url='+(null==(__t=encodeURIComponent(link))?"":__t)+'" class="detail-menu-sharing-button" data-action="share" data-network="twitter">\n      <i class="fa fa-twitter"></i>\n    </a>\n\n    <a href="#" class="detail-menu-sharing-button link-button" data-clipboard-text="'+(null==(__t=link)?"":__t)+'" title="'+__e(helpers.translation.__("SHARE_POST_LINK"))+'" data-action="detail-copy-link">\n      <i class="fa fa-link"></i>\n    </a>\n\n    <div class="detail-link-copied">\n      <span>'+__e(helpers.translation.__("COPIED_TO_CLIPBOARD"))+"<span>\n    </div>\n  </div>\n</div>\n";return __p};
window.templates=window.templates||{},window.templates["detail/post_image"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)postImage&&(__p+='\n  <div\n    class="detail-image '+(null==(__t=postVideoElement?"detail-image-with-video":"")?"":__t)+'"\n    data-image="'+__e(postImage)+'"\n    data-aspect-ratio="'+(null==(__t=imageAspectRatio)?"":__t)+'"\n  >\n    ',postVideoElement?__p+="\n      "+(null==(__t=postVideoElement)?"":__t)+"\n    ":__p+='\n      <div class="detail-image-inner" style="background-image: url('+__e(postImage)+')">\n      </div>\n    ',__p+="\n\n    ",postLink&&(__p+='\n      <a href="'+__e(postLink)+'" target="_blank" class="detail-image-link"></a>\n    '),__p+="\n  </div>\n"),__p+="\n";return __p};
window.templates=window.templates||{},window.templates["detail/sharing"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<span class="detail-sharing-intro">\n  '+__e(helpers.translation.__("SHARE_POST"))+'\n</span>\n\n<div class="detail-sharing-buttons">\n  <a href="https://www.facebook.com/sharer/sharer.php?u='+(null==(__t=encodeURIComponent(link))?"":__t)+'" class="detail-sharing-button" data-action="share" data-network="facebook">\n    <i class="fa fa-facebook"></i>\n  </a>\n\n  <a href="https://twitter.com/intent/tweet?url='+(null==(__t=encodeURIComponent(link))?"":__t)+"&text="+(null==(__t=encodeURIComponent(text))?"":__t)+"&via="+(null==(__t=twitterVia)?"":__t)+'" class="detail-sharing-button" data-action="share" data-network="twitter">\n    <i class="fa fa-twitter"></i>\n  </a>\n\n  <a href="https://plus.google.com/share?url='+(null==(__t=encodeURIComponent(link))?"":__t)+'" class="detail-sharing-button" data-action="share" data-network="googleplus">\n    <i class="fa fa-google-plus"></i>\n  </a>\n\n  <a href="#" class="detail-sharing-button link-button" data-clipboard-text="'+(null==(__t=link)?"":__t)+'" title="'+__e(helpers.translation.__("SHARE_POST_LINK"))+'" data-action="detail-copy-link">\n    <i class="fa fa-link"></i>\n  </a>\n\n  <div class="detail-link-copied">\n    <span>'+__e(helpers.translation.__("COPIED_TO_CLIPBOARD"))+"<span>\n  </div>\n</div>\n";return __p};
window.templates=window.templates||{},window.templates["detail/user"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="detail-user">\n  <a href="'+__e(userLink)+'" class="detail-user-image" target="_blank" style="background-image: url('+__e(userImage)+')">\n\n  </a>\n\n  <div class="detail-user-info">\n    <div class="detail-user-name" title="'+__e(combinedName)+'">\n      <i class="detail-network-icon detail-network-icon-'+__e(network)+'"></i>\n      <a href="'+__e(userLink)+'" target="_blank">'+__e(userName)+'</a>\n    </div>\n\n    <a href="'+__e(postLink)+'" class="detail-timestamp" target="_blank">'+__e(humanTimeDiff)+"</a>\n  </div>\n</div>\n";return __p};
window.templates=window.templates||{},window.templates["detail/video"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)postVideo&&(__p+='\n  <div class="video-wrapper detail-video-wrapper">\n    <video loop="loop" class="detail-video" poster="'+__e(postImage)+'">\n      <source src="'+__e(postVideo)+'" type="video/mp4" />\n    </video>\n\n    <div class="video-play-button"></div>\n  </div>\n'),__p+="\n";return __p};
window.templates=window.templates||{},window.templates["embeds/vimeo_embed"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<iframe class="checkin-video-embed" src="https://player.vimeo.com/video/'+__e(token)+'?autoplay=1&loop=1&title=0&byline=0&portrait=0" frameborder="0" allowfullscreen></iframe>\n';return __p};
window.templates=window.templates||{},window.templates["embeds/youtube_embed"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)muteValue=mute?1:0,__p+='\n<iframe class="checkin-video-embed" src="https://www.youtube-nocookie.com/embed/'+__e(token)+"?rel=0&amp;controls=0&amp;showinfo=0&amp;autoplay=1&amp;mute="+(null==(__t=muteValue)?"":__t)+'" frameborder="0" allowfullscreen></iframe>\n';return __p};
window.templates=window.templates||{},window.templates.checkin=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)imageInfoClass=image?"checkin-with-image":"checkin-without-image",extraCheckinClasses=extraCheckinClasses.join(" "),__p+='\n<div class="checkin checkin-before-show checkin-'+(null==(__t=id)?"":__t)+" "+(null==(__t=imageInfoClass)?"":__t)+" "+(null==(__t=extraCheckinClasses)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'" data-timestamp="'+(null==(__t=externalCreatedTimestamp)?"":__t)+'" data-type="'+(null==(__t=type)?"":__t)+'" data-user-id="'+(null==(__t=userId)?"":__t)+'" data-display-state="'+(null==(__t=initialDisplayState)?"":__t)+'" data-has-multiple-display-states="'+(null==(__t=hasMultipleDisplayStates)?"":__t)+'">\n  <div class="checkin-type checkin-type-'+(null==(__t=type)?"":__t)+' big-checkin-type big-checkin-type-hidden"></div>\n\n  <div class="checkin-content">\n    ',image&&(__p+='\n      <div class="checkin-image-measure"></div>\n      <div class="checkin-image-wrapper" data-aspect-ratio="'+(null==(__t=imageAspectRatio)?"":__t)+'">\n        <div class="checkin-image checkin-image-preview-holder" data-aspect-ratio="'+(null==(__t=imageAspectRatio)?"":__t)+'">\n          <div class="checkin-image-inner" style="background-image:url('+__e(image)+')"></div>\n\n          ',showPlayButton?__p+='\n            <div class="video-play-button"></div>\n          ':postLink&&(__p+='\n            <a href="'+__e(postLink)+'" target="_blank" class="checkin-image-link"></a>\n          '),__p+='\n\n          <div class="checkin-image-overlay"></div>\n        </div>\n      </div>\n    '),__p+='\n\n    <div class="checkin-secondary-content">\n      <div class="checkin-secondary-content-inner">\n        '+(null==(__t=user)?"":__t)+'\n\n        <div class="checkin-message-wrapper">\n          <div class="checkin-message">\n            '+(null==(__t=comment)?"":__t)+"\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n";return __p};
window.templates=window.templates||{},window.templates.user=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="checkin-user">\n  ',image&&(__p+="\n    ",userLink?__p+='\n      <a href="'+(null==(__t=userLink)?"":__t)+'" class="checkin-user-image" target="_blank" style="background-image: url('+(null==(__t=image)?"":__t)+')">\n      </a>\n    ':__p+='\n      <div class="checkin-user-image" style="background-image: url('+(null==(__t=image)?"":__t)+')">\n      </div>\n    ',__p+="\n  "),__p+='\n\n  <div class="checkin-user-name-wrapper">\n    ',userLink?__p+='\n      <div class="checkin-user-name" title="'+__e(combinedName)+'">\n        <span class="checkin-type checkin-type-'+(null==(__t=type)?"":__t)+'"></span>\n        <a href="'+(null==(__t=userLink)?"":__t)+'" target="_blank">\n          '+(null==(__t=nameParts)?"":__t)+"\n        </a>\n      </div>\n    ":__p+='\n      <div class="checkin-user-name" title="'+__e(combinedName)+'">\n        <span class="checkin-type checkin-type-'+(null==(__t=type)?"":__t)+'"></span>\n        '+(null==(__t=nameParts)?"":__t)+"\n      </div>\n    ",__p+="\n\n    ",postLink?__p+='\n      <a href="'+(null==(__t=postLink)?"":__t)+'" class="checkin-timestamp" data-timestamp="'+(null==(__t=externalCreatedTimestamp)?"":__t)+'" target="_blank"></a>\n    ':__p+='\n      <span class="checkin-timestamp" data-timestamp="'+(null==(__t=externalCreatedTimestamp)?"":__t)+'"></span>\n    ',__p+="\n  </div>\n</div>\n";return __p};
"use strict";window.helpers=(function(){var e=function(e){return"[data-action~='"+e+"']"},t=function(e,t){var r="",n=e;do{var u=n%t;n=Math.floor(n/t),r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/".charAt(u)+r}while(0!==n);return r},r=function(e,t){var r=e.split("");return _.reduce(r,(function(e,r){return e*t+"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/".indexOf(r)}),0)},n=function(e){if(!e)return 0;var t=0,r=(e=e.toString()).length;if(0===r)return t;for(var n=0;n<r;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return Math.abs(t)},u=function(e,t,r){if(r<=t)return e;var n=(e.length/r+1)/2,u=Math.round(t*n);return htmlTruncate(e,u,{ellipsis:"â€¦"})},a=function(e){return e&&"object"===$.type(e)&&e.name?e.name:e&&"object"===$.type(e)&&e.title?e.title:e&&"object"===$.type(e)&&e.username?e.username:e&&"object"===$.type(e)&&e.id?e.id:$.isNumeric(e)||"string"===$.type(e)?""+e:"Facebook Page"},o=function(e){return"@"+e.username},i=function(e){return e.name||o(e)},c=function(e){return e.name},f=function(e){return e.name},s=function(e){return e.name},l=function(e){var t=e.external_name;return{username:t,name:e.external_fullname||t}},m=function(e){var t=l(e);return _.includes(["twitter","instagram"],e.type)?o(t):t.username},h=function(e){var t=l(e);switch(e.type){case"twitter":case"instagram":return i(t);case"facebook":return a(t);case"googleplus":return c(t);case"youtube":return f(t);case"pinterest":return s(t)}return t.name},d=function(e){switch(e){case"googleplus":return"Google+";case"foursquare":return"Foursquare / Swarm";case"youtube":return"YouTube";case"rss":return"RSS";case"ads":return"Advertising";case"vkontakte":return"VKontakte";default:return (function(e){return e.charAt(0).toUpperCase()+e.slice(1)})(e)}},g=function(e,t){return t||("facebook"===e?"page":"profile")};return{$actionElement:function(t){return $(e(t))},actionSelector:e,autoBind:function(e){var t=!0,r=!1,n=void 0;try{for(var u,a=Object.getOwnPropertyNames(e.constructor.prototype)[Symbol.iterator]();!(t=(u=a.next()).done);t=!0){var o=u.value,i=e[o];"constructor"!==o&&"function"==typeof i&&(e[o]=i.bind(e))}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e},getChannelName:d,getSourceName:function(e,t){return d(e)+" "+g(e,t)},getUnixTimestamp:function(){return Math.floor(Date.now()/1e3)},checkins:{getShortName:m,getFullName:h,getCombinedName:function(e){var t=l(e),r=m(e),n=h(e);return n?r?t.name===t.username?r:r+" ("+n+")":n:r}},jQuery:{stringify:function(e){return $("<div>").append(e.clone()).html()}},string:{hash:n},integer:{ceilTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.ceil(e/t)*t},getRandomSeededInt:function(e,t,r){r+=1,e=n(e);var u=(e=1e4*Math.sin(e))-Math.floor(e);return Math.floor(u*(r-t))+t}},slug:{fromId:function(e){return t(e,62)},toId:function(e){return r(e,62)}},truncateTransformedTextPrecise:function(e,t,r){for(var n=t,a=0;;){var o=u(e,n,r);if($("<div>").html(o).text().length<=t)return o;if(n=Math.ceil(.9*n),++a>=50)return o}}}})();
"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}})();!(function(){var e=(function(){function e(){_classCallCheck(this,e),this.isCancelled=!1,this.scheduledActions=new Immutable.List,helpers.autoBind(this)}return _createClass(e,[{key:"do",value:function(e){return this.scheduledActions=this.scheduledActions.push(e),this}},{key:"wait",value:function(n){return this.do((function(){return new Promise(function(t){var i=e.now();requestAnimationFrame((function r(){if(e.now()>i+n)return t();requestAnimationFrame(r)}))})})),this}},{key:"run",value:function(){var e=this,n=Promise.resolve();return this.scheduledActions.forEach((function(t){n=n.then((function(){if(!e.isCancelled)return t()}))})),this.scheduledActions=this.scheduledActions.clear(),n}},{key:"cancel",value:function(){this.scheduledActions=this.scheduledActions.clear(),this.isCancelled=!0}}],[{key:"now",value:function(){return window.performance&&window.performance.now?window.performance.now():Date.now()}},{key:"callAfter",value:function(n,t){return(new e).wait(t).do((function(){return n()})).run()}}]),e})();window.helpers.Animation=e})();
"use strict";function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function n(n,t){for(var a=0;a<t.length;a++){var e=t[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(t,a,e){return a&&n(t.prototype,a),e&&n(t,e),t}})();!(function(){var n=function(n,t,a){var e=n,r=a,s=t,i=e/2-r,l=Math.atan(s/i),u=Math.asin(r*Math.sin(l)/e);return(Math.PI-l-u)*(180/Math.PI)},t=function(n,t,a){var e=t/n*2,r=Math.atan(e),s=Math.sin(r),i=t/s,l=a,u=l*l+i*i-2*l*i*Math.cos(r),c=i*s/Math.sqrt(u),o=Math.asin(c),h=Math.PI-o,f=l*Math.sin(h)/n,M=Math.asin(f),d=(Math.PI-h-M)*(180/Math.PI);return d<0?0:d},a=(function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"addRule",value:function(n,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,e=$("#dynamic-css");0===e.length&&(e=$("<style>").attr("id","dynamic-css").appendTo("body"));var r=e[0].sheet;a<0&&(a=_.get(r,"cssRules.length",0)),"addRule"in r?r.addRule(n,t,a):"insertRule"in r&&r.insertRule(n+"{"+t+"}",a)}},{key:"getTransformAngle",value:function(a,e,r){return r<a/2?n(a,e,r):t(a,e,r)}}]),a})();window.helpers.Css=a})();
"use strict";function _classCallCheck(n,a){if(!(n instanceof a))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function n(n,a){for(var e=0;e<a.length;e++){var i=a[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(a,e,i){return e&&n(a.prototype,e),i&&n(a,i),a}})();!(function(){var n=(function(){function n(a){_classCallCheck(this,n),this.wallOptions=a}return _createClass(n,null,[{key:"trackGaTiming",value:function(n,a,e){if(window.ga&&Date.now){WallTimings[n]=Date.now();var i=WallTimings[n]-WallTimings.pageload;i>6e4||ga("send",{hitType:"timing",timingCategory:a,timingVar:e,timingValue:i})}}}]),n})();window.helpers.Tracking=n})();
"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}})();!(function(){var e=(function(){function e(n){_classCallCheck(this,e),this.wallOptions=n}return _createClass(e,null,[{key:"build",value:function(e,n){var t=_.get(templates,e);return t?t(n):""}}]),e})();window.helpers.Templates=e})();
"use strict";window.helpers.translation=(function(){var r=function(r){var t=WallMessages.items[r];if(t)return t;var a=WallMessages.plurals[r];if(a){var n=WallMessages.items[a];if(n)return n}return[r]},t=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=r(t),e=n[a];return e||n[0]},a=function(r,t){if(0===t.length)return r;for(var a=/\%(s|d)/,n=1;a.test(r);n++)r=r.replace(a,"%"+n+"$s");var e={},i=[];t.forEach((function(r,t){var a="\\%("+(t+1)+")\\$s";e["%"+(t+1)+"$s"]=r,i.push(a)}));var l=new RegExp(i.join("|"),"g");return r.replace(l,(function(r){return e[r]}))},n=function(r){for(var n=arguments.length,e=Array(n>1?n-1:0),i=1;i<n;i++)e[i-1]=arguments[i];var l=t(r);return a(l,e)};return{translateText:function(){var r=function(r,t){var a=t.split("=");if(!(a.length<2)){var e=a[0],i=a[1];e&&i&&r.attr(e,n(i))}};$("[data-translate]").each((function(){var r=$(this),t=r.data("translate");r.html(n(t))})),$("[data-translate-attribute]").each((function(){var t=$(this),a=t.data("translate-attribute").split("|"),n=!0,e=!1,i=void 0;try{for(var l,s=a[Symbol.iterator]();!(n=(l=s.next()).done);n=!0){var u=l.value;r(t,u)}}catch(r){e=!0,i=r}finally{try{!n&&s.return&&s.return()}finally{if(e)throw i}}}))},__:n,__n:function(r,n,e){for(var i=arguments.length,l=Array(i>3?i-3:0),s=3;s<i;s++)l[s-3]=arguments[s];var u=WallMessages.pluralFunction(e),o=t(u>0?n:r,u);return a(o,l)}}})();
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}})();!(function(){var e=$("body"),t=$(window),n=helpers.translation.__,i=helpers.translation.__n,o=helpers.Animation,a=(function(){function a(e){_classCallCheck(this,a),this.wallOptions=e,this.disconnectTimeout=null,this.reconnectTimeout=null,this.serverStartedAt=null,helpers.autoBind(this)}return _createClass(a,[{key:"prepareEntities",value:function(e){if(!e.entities)return e;var t=void 0;try{t=JSON.parse(e.entities)}catch(e){}return t||(t={}),e.entities=t,e}},{key:"getRandomCheckinColorClass",value:function(e){var t=this.wallOptions.colorCount;return"checkin-color-"+helpers.integer.getRandomSeededInt(e,1,t)}},{key:"initUser",value:function(){betterFetch.json(this.wallOptions.webAppPath+"/walls/user_status.json",{wall_id:this.wallOptions.wallId}).then((function(e){$("html").toggleClass("has-wall-access",e.canEditWall).toggleClass("has-moderation-access",e.canModerateWall).toggleClass("is-logged-in",e.isLoggedIn).toggleClass("is-not-logged-in",!e.isLoggedIn),e.overlayBar&&a.showNotificationBar(e.overlayBar)})).catch((function(e){})).then((function(){$("html").removeClass("user-status-unknown")}))}},{key:"generateInstructions",value:function(){var e=$(".post_instructions"),t=this.wallOptions.postInstructions,i=$("<ul>"),o=t.basic||[],a=t.networks||[],l=!0,s=!1,r=void 0;try{for(var c,u=o[Symbol.iterator]();!(l=(c=u.next()).done);l=!0){var d=c.value;if(d){var h=$("<li>").text(d);i.append(h)}}}catch(e){s=!0,r=e}finally{try{!l&&u.return&&u.return()}finally{if(s)throw r}}var f=!0,v=!1,p=void 0;try{for(var m,w=a[Symbol.iterator]();!(f=(m=w.next()).done);f=!0){var k=m.value,g=$("<li>").html(n(k.message,k.tags));i.append(g)}}catch(e){v=!0,p=e}finally{try{!f&&w.return&&w.return()}finally{if(v)throw p}}e.addClass("post-instructions-hidden"),e.html(i.contents())}},{key:"getWallSocket",value:function(){var e=this,t=$.param({wallId:this.wallOptions.wallId,client:"wallsio-frontend-2017_8_24",initialCheckins:this.wallOptions.initialCheckins,cookieSupport:a.hasCookieSupport()?1:0,network:this.wallOptions.network}),n=this.wallOptions.nodeUrl+"?"+t,i=io(n,{reconnectionDelay:2e3,reconnectionDelayMax:15e3});return i.on("reload wall",(function(){a.reloadWall(i)})),i.on("wallping",(function(t){e.serverStartedAt?e.serverStartedAt!==t.serverStartedAt&&a.reloadWall(i):e.serverStartedAt=t.serverStartedAt})),i}},{key:"initDynamicDisconnect",value:function(e){var t=this;$(document).on("visibilitychange",(function(){"visible"===document.visibilityState?(clearTimeout(t.disconnectTimeout),e.connected||(t.reconnectTimeout=setTimeout((function(){e.connect(),$("html").removeClass("socket-disconnected")}),1500))):(clearTimeout(t.reconnectTimeout),e.connected&&(t.disconnectTimeout=setTimeout((function(){e.disconnect(),$("html").addClass("socket-disconnected")}),48e4)))}))}},{key:"loadCachedCheckins",value:function(){return betterFetch.json(this.wallOptions.webAppPath+"/get_cached_checkins.json",{wallId:this.wallOptions.wallId}).then((function(e){return e.cachedCheckins}))}}],[{key:"reloadWall",value:function(e){e.disconnect(),$(document).off("visibilitychange");var t=Math.floor(500+1e4*Math.random());setTimeout((function(){location.reload()}),t)}},{key:"humanTimeDiff",value:function(e){if((e=Math.floor(e/1e3))<5)return n("THIS_MOMENT");if(e<60){var t=Math.floor(e);return i("A_SECOND_AGO","%s_SECONDS_AGO",t,t)}if(e<3600){var o=Math.floor(e/60);return i("A_MINUTE_AGO","%s_MINUTES_AGO",o,o)}if(e<86400){var a=Math.floor(e/3600);return i("AN_HOUR_AGO","%s_HOURS_AGO",a,a)}if(e<2592e3){var l=Math.floor(e/86400);return i("A_DAY_AGO","%s_DAYS_AGO",l,l)}var s=Math.floor(e/604800);return i("A_WEEK_AGO","%s_WEEKS_AGO",s,s)}},{key:"forceSSL",value:function(e){return _.isString(e)?e.replace(/^http:/i,"https:"):e}},{key:"showNotificationBar",value:function(e){var t=e.markup,n=e.autoshowhideInterval,i=e.displayTimeout,o=void 0===i?4e3:i,a=$(t);$(".wall-notifications").append(a),setTimeout((function(){a.addClass("wall-notification-visible"),n&&setInterval((function(){a.toggleClass("wall-notification-visible")}),n)}),o)}},{key:"loopInstructions",value:function(){var e=$(".post_instructions"),t=e.find("li"),n=e.find("li.is-visible");if(t.length){var i=n.next();i.length||(i=e.find("li").first());var l=i.text().length,s=Math.round(l/2),r=e.css("transition-timing-function").replace(/steps\(\d+/gi,"steps("+s);e.css("transition-timing-function",r),(new o).do((function(){e.addClass("post-instructions-hidden")})).wait(450).do((function(){n.removeClass("is-visible"),i.addClass("is-visible")})).wait(500).do((function(){e.removeClass("post-instructions-hidden")})).wait(7500).do(a.loopInstructions).run()}}},{key:"hasCookieSupport",value:function(){return!!_.isString(document.cookie)&&(!!navigator.cookieEnabled&&(document.cookie="cookieSupport=1",document.cookie.indexOf("cookieSupport")>=0))}},{key:"initClipboard",value:function(){new Clipboard("[data-clipboard-text]"),$("[data-clipboard-text]").on("click",(function(e){e.preventDefault();var t=$(this).next(".copied");t.addClass("copied-visible"),setTimeout((function(){return t.removeClass("copied-visible")}),3e3)}))}},{key:"initFilter",value:function(t,n){var i=$(".show-filter"),o=$(".filter-menu-reset"),a=$(".filter-menu-network");a.each((function(){var e=$(this);e.on("click",(function(){e.hasClass("filter-menu-network-selected")?(e.removeClass("filter-menu-network-selected"),n()):(a.removeClass("filter-menu-network-selected"),e.addClass("filter-menu-network-selected"),t(e.data("network")))}))})),i.on("click",(function(){e.toggleClass("show-filter-menu")})),o.on("click",(function(){a.removeClass("filter-menu-network-selected"),n()})),a.add(o).on("click",(function(){0===$(this).closest(".wall-toolbar").length&&e.removeClass("show-filter-menu"),window.scrollTo(0,0)}))}},{key:"addImageAndMessageClasses",value:function(e,t,n,i){var o=[],a=void 0;return a="wrapper"===t?"checkin-wrapper-":"checkin-",n&&i?o=[a+"with-image",a+"with-message",a+"with-image-and-message"]:n?o=[a+"with-image",a+"without-message"]:i&&(o=[a+"with-message",a+"without-image"]),e.addClass(o.join(" ")),e}},{key:"isAppScrollable",value:function(){return $("body").hasClass("scrollable")}},{key:"isIframe",value:function(){try{return window.self!==window.top}catch(e){return!0}}},{key:"isMobile",value:function(){return $("html").hasClass("mobile")}},{key:"isAutoheight",value:function(){return a.isIframe()&&$("html").hasClass("autoheight")}},{key:"isElementVisible",value:function(e){var t=$(e);return!t.is(":hidden")&&("hidden"!==t.css("visibility")&&(0!==parseInt(t.css("opacity"),10)&&(0===t.parent().length||t.parent()[0]===document||a.isElementVisible(t.parent()))))}},{key:"isInViewport",value:function(e){if(!a.isElementVisible(e))return!1;var n=e.getBoundingClientRect();return n.bottom>=0&&n.right>=0&&n.top<=t.height()&&n.left<=t.width()}},{key:"isMiddleInViewport",value:function(e){if(!a.isElementVisible(e))return!1;var n=e.getBoundingClientRect(),i=n.top+n.height/2,o=n.left+n.width/2;return i>=0&&i<=t.height()&&o>=0&&o<=t.width()}},{key:"getWallHeight",value:function(){return $("html")[0].scrollHeight}},{key:"hideWallInfo",value:function(){$("html").addClass("hide-wall-info")}},{key:"showWallInfo",value:function(e){$("html").removeClass("hide-wall-info"),$(".wall-info").text(e)}},{key:"updateTimestamps",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;(t?$(".checkin-"+t).find(".checkin-timestamp"):$(".checkin-timestamp")).each((function(){var t=$(this).attr("data-timestamp"),i=void 0;t&&(i=(e||Date.now())-t,$(this).text(n.humanTimeDiff(i)))}))}},{key:"getWindowMode",value:function(){return t.width()>t.height()?"landscape":"portrait"}},{key:"isLandscape",value:function(){return"landscape"===a.getWindowMode()}},{key:"isPortrait",value:function(){return"portrait"===a.getWindowMode()}}]),a})();window.helpers.Wall=a})();
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=(function(){function e(e,t){var a=[],r=!0,i=!1,n=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);r=!0);}catch(e){i=!0,n=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw n}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),_createClass=(function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}})();!(function(){var e=["post_image","external_image"],t=["post_image"],a=["post_image","external_image"],r=(function(){function r(e){_classCallCheck(this,r),this.wallOptions=e,helpers.autoBind(this)}return _createClass(r,[{key:"makeUrlAbsolute",value:function(e){return r.isAbsoluteUrl(e)?e:this.wallOptions.webAppPath+e}},{key:"getProxyHost",value:function(e){var t=this.wallOptions.proxyHosts;if(!_.isArray(t))return null;var a=t.length;return t[helpers.string.hash(e)%a]}},{key:"getProxyUrl",value:function(e,t,a){var i=this.getProxyHost(e);if(!i||!r.isAbsoluteUrl(e))return e;var n={src:e,w:this.wallOptions.proxyImageWidth,h:this.wallOptions.proxyImageHeight,q:this.wallOptions.proxyImageQuality,nu:1,salt:this.wallOptions.proxySalt};return t&&(n.key=t),this.wallOptions.proxyNoCache&&(n.nc=1),_.isPlainObject(a)&&(n=_.assign(n,a)),_.get(window,"devicePixelRatio",1)>=1.5&&(n.w&&(n.w=2*n.w),n.h&&(n.h=2*n.h)),e=i+"?"+$.param(n)}},{key:"proxyImage",value:function(e,t,a){return e=this.makeUrlAbsolute(e),e=this.getProxyUrl(e,t,a),e=helpers.Wall.forceSSL(e)}},{key:"prepareImages",value:function(a,i){var n=this;return _.each(e,(function(e){if(a[e]){var t=void 0,r=e+"_key",o=e+"_original";a[o]?a[e]=a[o]:a[o]=a[e],t="external_image"===e?_.assign({},i,{w:n.wallOptions.proxyProfileImageWidth,h:n.wallOptions.proxyProfileImageHeight}):i,a[e]=n.proxyImage(a[e],a[r],t)}})),_.each(t,(function(e){a=r.addPreviewImage(a,e)})),a.post_video&&(a.post_video=helpers.Wall.forceSSL(a.post_video)),a}},{key:"getAspectRatio",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e[t+"_aspect_ratio"];return i&&!1!==a.enableAspectRatioImages?r?i:i<a.minPostImageAspectRatio?a.minPostImageAspectRatio:i>a.maxPostImageAspectRatio?a.maxPostImageAspectRatio:i:a.defaultPostImageAspectRatio}}],[{key:"buildBase64Image",value:function(e){var t="data:image/jpg;base64,";if(e.indexOf("~")>-1){var a=e.split("~"),r=_slicedToArray(a,2);return t+"/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2ODApLCBxdWFsaXR5ID0gNjAK/9sAQwANCQoLCggNCwoLDg4NDxMgFRMSEhMnHB4XIC4pMTAuKS0sMzpKPjM2RjcsLUBXQUZMTlJTUjI+WmFaUGBKUVJP/9sAQwEODg4TERMmFRUmTzUtNU9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09P/8AAEQgA"+r[0]+"AwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A"+r[1]}return t+e}},{key:"preloadImage",value:function(e){if(e){var t=new Image;try{t.src=e}catch(e){}}}},{key:"isAbsoluteUrl",value:function(e){return/^\w+:\/\//.test(e)}},{key:"addPreviewImage",value:function(e,t){var a=t+"_preview";if(e[a]){var i=".checkin-"+e.id+" .checkin-image-preview-holder",n=r.buildBase64Image(e[a]);helpers.Css.addRule(i,'background-image:url("'+n+'")')}return e}},{key:"preloadImages",value:function(e){_.each(a,(function(t){e[t]&&r.preloadImage(e[t])}))}},{key:"getTwoDominantColors",value:function(e){var t=e.post_image_dominant_colors;if(!t)return null;var a=t.split(",");return a.length<2?null:a.slice(0,2)}}]),r})();helpers.Image=r})();
"use strict";helpers.sharing=(function(){var n=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=555,r=400;return"twitter"===t&&(r=260),"googleplus"===t&&(e=400),window.open(n,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width="+e+",height="+r),!1};return{initSharingLinks:function(){$(document).on("click",helpers.actionSelector("share"),(function(t){t.preventDefault();var e=$(this);n(e.attr("href"),e.attr("data-network"))}))},openSharingWindow:n}})();
"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function e(e,i){for(var t=0;t<i.length;t++){var o=i[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(i,t,o){return t&&e(i.prototype,t),o&&e(i,o),i}})();!(function(){var e=(function(){function e(i,t,o){_classCallCheck(this,e),this.isVideoAutochangeActive=!0,this.changeVideoTimeout=null,this.networksWithVideoEmbeds=i.networksWithVideoEmbeds,this.WallHelper=t,this.TemplatesHelper=o,helpers.autoBind(this)}return _createClass(e,[{key:"hasEmbeddedVideoSupport",value:function(e){return _.includes(this.networksWithVideoEmbeds,e.type)}},{key:"getVisibleVideoCheckins",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=$(".socialwall_container").find(".checkin"),t=_.chain(i).filter(this.WallHelper.isMiddleInViewport).filter((function(e){return!!$(e).data("video-url")})).shuffle().slice(0,e).value();return $(t)}},{key:"displayVideo",value:function(i){if(!i.hasClass("checkin-with-video")){i.addClass("checkin-with-video");var t=i.data("video-url"),o=i.find(".checkin-image"),n=i.find(".checkin-image-inner"),s=$(this.TemplatesHelper.build("checkin_video",{videoUrl:t}));n.length>0?s.prependTo(n):s.prependTo(o);var a=s.find("video"),l=0;void 0===Modernizr.videoautoplay&&(l=100),setTimeout((function(){Modernizr.videoautoplay&&e.play(a),e.mute(a)}),l)}}},{key:"displayNewVideos",value:function(i){var t=this;e.removeAllOtherVideos(i),i.each((function(e,i){t.displayVideo($(i))}))}},{key:"changeVideos",value:function(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;clearTimeout(this.changeVideoTimeout),this.changeVideoTimeout=setTimeout((function(){if(e.isVideoAutochangeActive)if(Modernizr.videoautoplay){var i=e.getVisibleVideoCheckins(3);0===i.length?e.changeVideos(1e3):(e.displayNewVideos(i),e.changeVideos(15e3))}else{var t=e.getVisibleVideoCheckins();e.displayNewVideos(t),e.changeVideos(400)}}),i)}},{key:"setVideoAutochangeActive",value:function(i){this.isVideoAutochangeActive=i,!1===i?e.removeAllVideos():this.changeVideos(0)}},{key:"initChangeVideoOnScrollListener",value:function(){var e=this,i=$(window),t=i.scrollTop();i.on("scroll",_.throttle((function(){var o=i.scrollTop(),n=i.height();Math.abs(o-t)<n/2||(e.changeVideos(),t=i.scrollTop())}),300))}},{key:"initEventListeners",value:function(){if(e.isVideoSupportedByBrowser()){var i=$(".socialwall_container, .detail-mount-point");i.on("click",".video-mute-button",(function(){var i=$(this).closest(".video-wrapper"),t=i.find("video");return i.hasClass("video-muted")?(e.unmute(t),e.muteAllOtherVideos(t)):e.mute(t),!1})),i.on("click",".video-play-button",(function(){var i=$(this).closest(".checkin-image-wrapper").find(".checkin-video");return!i.length||(e.play(i),!1)})),this.initChangeVideoOnScrollListener()}}},{key:"init",value:function(){this.initEventListeners(),this.changeVideos(2e3)}}],[{key:"hasRealVideo",value:function(e){return!!e.post_video}},{key:"setPlayClasses",value:function(e){e.closest(".video-wrapper").addClass("video-playing"),e.closest(".checkin").addClass("checkin-with-video-playing")}},{key:"setPauseClasses",value:function(e){e.closest(".video-wrapper").removeClass("video-playing"),e.closest(".checkin").removeClass("checkin-with-video-playing")}},{key:"play",value:function(i){var t=$(i).eq(0),o=(i=t.get(0)).play();o&&o.then?o.then((function(){e.setPlayClasses(t)})):e.setPlayClasses(t)}},{key:"pause",value:function(i){var t=$(i).eq(0);(i=t.get(0)).pause(),e.setPauseClasses(t)}},{key:"mute",value:function(e){var i=$(e).eq(0);(e=i.get(0)).muted=!0,i.closest(".video-wrapper").addClass("video-muted")}},{key:"unmute",value:function(e){var i=$(e).eq(0);(e=i.get(0)).muted=!1,i.closest(".video-wrapper").removeClass("video-muted")}},{key:"muteVimeoEmbed",value:function(e){var i=e.find(".checkin-video-embed");0!==i.length&&"vimeo"===e.data("type")&&i.get(0).contentWindow.postMessage(JSON.stringify({method:"setVolume",value:0}),"*")}},{key:"removeVideoClasses",value:function(e){var i=$(e).eq(0).closest(".video-wrapper");i.removeClass("video-muted video-playing"),i.closest(".checkin").removeClass("checkin-with-video checkin-with-video-playing")}},{key:"muteAllOtherVideos",value:function(i){var t=i.get(0);$(".checkin-video").each((function(i,o){o!==t&&e.mute(o)}))}},{key:"destroyVideo",value:function(i){var t=$(i).eq(0);(i=t.get(0))&&(e.pause(i),setTimeout((function(){e.removeVideoClasses(i),t.closest(".video-wrapper").remove()}),0))}},{key:"removeAllOtherVideos",value:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=$(".socialwall_container").find(".checkin-with-video");i&&i.length&&(t=t.filter((function(e,t){return!_.includes(i.toArray(),t)}))),t.removeClass("checkin-with-video"),t.each((function(i,t){e.destroyVideo($(t).find(".checkin-video"))}))}},{key:"removeAllVideos",value:function(){e.removeAllOtherVideos(null)}},{key:"initVideo",value:function(e,i){var t=e.post_video;t&&i.attr("data-video-url",t)}},{key:"isVideoSupportedByBrowser",value:function(){return"play"in document.createElement("video")}}]),e})();window.helpers.Video=e})();
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}})();!(function(){var e=(function(){function e(t,n){_classCallCheck(this,e),this.wallOptions=t,this.wallState=n,this.bottomAddedCheckinsCounter=1,this.topAddedCheckinsCounter=1,helpers.autoBind(this)}return _createClass(e,[{key:"isNewAdNeeded",value:function(){var e=this.wallState.getSortedCheckinsData(),t=this.wallOptions.adsFrequency,n=Math.ceil(.15*t);return t+=_.random(-n,n),this.wallState.checkinsDataSize<t&&!e.some((function(e){return"sponsored"===e.type}))||!e.slice(0,t).some((function(e){return"sponsored"===e.type}))}},{key:"createCheckinDataFromAd",value:function(e){var t={};return t.id=e.id+"-"+Date.now(),t.post_id=e.id,t.post_image=e.image,t.post_image_aspect_ratio=e.image_aspect_ratio,t.post_image_key=e.image_key,t.post_image_dominant_colors=e.image_dominant_colors,t.post_link=e.link,t.type="sponsored",t=new helpers.Image(this.wallOptions).prepareImages(t,{q:95}),helpers.Image.preloadImages(t),t=this.prepareRankingData(t,"top"),t=this.makeCheckinTopRanked(t,this.wallState)}},{key:"getSortField",value:function(){return{weight:"weight",time:"external_created_timestamp",addOrder:"addOrder"}[this.wallOptions.clientRankingMode]}},{key:"addSortScoreToCheckin",value:function(e){var t=this.getSortField(),n=this.wallOptions.clientRankingMode,a=["weight","time"];if(!t)return e.sortScore=0,e;var i=e[t],r=e.bonus||0;return _.includes(a,n)&&(i+=r),e.sortScore=i,e}},{key:"makeCheckinTopRanked",value:function(e){var t=this.wallState.getSortedCheckinsData().first(),n=void 0,a=void 0,i=void 0;return t&&("weight"===this.wallOptions.clientRankingMode?(a=t.weight+t.bonus,i=e.weight):"time"===this.wallOptions.clientRankingMode?(a=t.external_created_timestamp+t.bonus,i=e.external_created_timestamp):"addOrder"===this.wallOptions.clientRankingMode&&(a=t.addOrder+t.bonus,i=e.addOrder),n=a-i+1,n=Math.max(n,0),e.bonus=n),e=this.addSortScoreToCheckin(e)}},{key:"prepareRankingData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.bonus=e.bonus||0,e.weight=e.weight||0,e.external_created_timestamp=e.external_created_timestamp||0,"top"===t?(e.addOrder=this.topAddedCheckinsCounter,this.topAddedCheckinsCounter++):"bottom"===t?(e.addOrder=-1*this.bottomAddedCheckinsCounter,this.bottomAddedCheckinsCounter++):n&&n.addOrder&&(e.addOrder=n.addOrder),e=this.addSortScoreToCheckin(e)}}],[{key:"compare",value:function(e,t){var n=[],a=_.intersection(_.keys(e),_.keys(t));return _.each(a,(function(a){_.isEqual(e[a],t[a])||n.push(a)})),n}},{key:"prepareComment",value:function(e,t){if(!e.html_comment)return e;var n=e.comment,a=e.html_comment,i=t,r=n.length;return a=helpers.truncateTransformedTextPrecise(a,i,r),e.truncated_html_comment=a,e}}]),e})();window.helpers.Checkins=e})();
"use strict";function _classCallCheck(a,o){if(!(a instanceof o))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function a(a,o){for(var t=0;t<o.length;t++){var i=o[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,i.key,i)}}return function(o,t,i){return t&&a(o.prototype,t),i&&a(o,i),o}})();!(function(){var a=(function(){function a(o){_classCallCheck(this,a),this.wallOptions=o,this.originalLocation={hash:location.hash,host:location.host,hostname:location.hostname,href:location.href,origin:location.origin,pathname:location.pathname,port:location.port,protocol:location.protocol,search:location.search}}return _createClass(a,[{key:"getWallUrl",value:function(){var a=this.wallOptions.wallUrl;return this.originalLocation.search&&(a+=this.originalLocation.search),this.originalLocation.hash&&(a+=this.originalLocation.hash),a}},{key:"getDetailUrl",value:function(a){var o=this.wallOptions.wallUrl+"/p/"+a;return this.originalLocation.search&&(o+=this.originalLocation.search),this.originalLocation.hash&&(o+=this.originalLocation.hash),o}},{key:"getCompactDetailUrl",value:function(a){return this.wallOptions.webAppPath+"/s/"+a}}]),a})();window.helpers.Url=a})();
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function e(e,t){for(var l=0;l<t.length;l++){var r=t[l];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,l,r){return l&&e(t.prototype,l),r&&e(t,r),t}})();!(function(){var e=(function(){function e(t){_classCallCheck(this,e),this.urlHelper=new helpers.Url(t)}return _createClass(e,[{key:"setUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(window.history.pushState){var l=this.urlHelper.getCompactDetailUrl(e);t?window.history.replaceState({detail:e},null,l):window.history.pushState({detail:e},null,l)}}},{key:"clearUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(window.history.pushState){var t=this.urlHelper.getWallUrl();e?window.history.replaceState({detail:null},null,t):window.history.state&&window.history.state.detail&&window.history.pushState({detail:null},null,t)}}}]),e})();window.helpers.Route=e})();
"use strict";!(function(){var e=$("body"),l=$("html, body"),n=(screenfull.enabled&&document.addEventListener(screenfull.raw.fullscreenchange,(function(){screenfull.isFullscreen?(l.addClass("fullscreen"),scrollTo(0,0)):l.removeClass("fullscreen")})),{enter:function(){screenfull.enabled&&screenfull.request()},leave:function(){screenfull.enabled&&screenfull.exit()},isSupported:function(){return screenfull.enabled},isFullscreen:function(){return screenfull.isFullscreen},getFullscreenChangeEventName:function(){return _.get(screenfull,"raw.fullscreenchange")}});screenfull.enabled&&(e.addClass("fullscreen-support"),e.on("click",".fullscreen-enter",n.enter),e.on("click",".fullscreen-leave",n.leave)),window.WallsioFullscreen=n})();
"use strict";$((function(){var o=!1,n=null,e=$("body"),t=function(){o=!0,e.addClass("mousemoving")},u=function(){o=!1,e.removeClass("mousemoving")},s=function(){clearTimeout(n),n=setTimeout(u,2e3)};$(document).on("mousemove scroll",_.throttle((function(){o||t(),s()}),100))}));
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}})();!(function(){var e=(function(){function e(t,a){_classCallCheck(this,e),this.Wall=t,this.WallHelper=a,helpers.autoBind(this),this.requestOlderCheckinsThrottled=_.throttle((function(e){return t.requestOlderCheckins(e)}),1e3)}return _createClass(e,[{key:"sendDocumentHeight",value:function(){e.sendPostMessage("Wallsio.height",this.WallHelper.getWallHeight())}},{key:"initDomEvents",value:function(){var e=this;$(window).on("message",(function(t){var a=t.originalEvent.data;if(a)switch(a.method){case"Wallsio.requestOlderCheckins":var n=_.get(a.args,0);e.requestOlderCheckinsThrottled(n);break;case"Wallsio.getHeight":e.sendDocumentHeight.apply(e,a.args);break;case"Wallsio.setAutoFillEnabled":var s=_.get(a.args,0);e.Wall.setAutofillEnabled(s)}}))}}],[{key:"sendPostMessage",value:function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];window!==parent&&parent.postMessage&&parent.postMessage({method:e,args:a},"*")}}]),e})();window.PostmessageApi=e})();
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}})();!(function(){var t=(function(){function t(e,i,a){_classCallCheck(this,t),this._stack=Immutable.List(),this._checkinsData=Immutable.Map(),this._sortedCheckinsData=Immutable.List(),this._newCheckinSortScoreThreshold=-1/0,this.wallOptions=e,this.isAppScrollable=i,this.getTilesLimit=a,helpers.autoBind(this)}return _createClass(t,[{key:"addToStack",value:function(t){this._stack=this._stack.push(t)}},{key:"shiftStack",value:function(){var t=this._stack.first();return this._stack=this._stack.shift(),t}},{key:"filterStack",value:function(t){this._stack=this._stack.filter(t)}},{key:"truncateStack",value:function(t){this._stack=this._stack.takeLast(t)}},{key:"truncateCheckinData",value:function(t){var e=this.getSortedCheckinsData().slice(t);if(0!==e.size){var i=e.map((function(t){return t.id}));this.removeCheckinData(i.toArray())}}},{key:"isStackEmpty",value:function(){return 0===this.stackSize}},{key:"isCheckinsDataEmpty",value:function(){return 0===this.checkinsDataSize}},{key:"getCheckinData",value:function(e){e=t.normalizeCheckinId(e);return this._checkinsData.get(e,null)}},{key:"hasCheckin",value:function(e){return e=t.normalizeCheckinId(e),this._checkinsData.has(e)}},{key:"setCheckinData",value:function(e,i){e=t.normalizeCheckinId(e),this._checkinsData=this._checkinsData.set(e,i),this.updateSortedCheckinsData()}},{key:"removeCheckinData",value:function(e){_.isArray(e)||(e=[e]),e=_.map(e,t.normalizeCheckinId),this._checkinsData=this._checkinsData.deleteAll(e),this.updateSortedCheckinsData()}},{key:"getAllCheckinsData",value:function(){return this._checkinsData}},{key:"getSortedCheckinsData",value:function(){return this._sortedCheckinsData}},{key:"getCheckinIds",value:function(){return this._checkinsData.keySeq().toList()}},{key:"updateSortedCheckinsData",value:function(){var t=this._checkinsData.toList(),e=!0,i=!1,a=void 0;try{for(var n,s=this.checkinsDataSortFunctions[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var r=n.value;t=t.sortBy(r)}}catch(t){i=!0,a=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw a}}this._sortedCheckinsData=t,this.updateNewCheckinSortScoreThreshold()}},{key:"updateNewCheckinSortScoreThreshold",value:function(){if(!this.isAppScrollable)return!1;var t=this.getTilesLimit(this.wallOptions,!0),e=Math.round(t/2);if(this._sortedCheckinsData.size<e)return!1;var i=e-1,a=this._sortedCheckinsData.get(i);if(!a||!a.sortScore)return!1;this._newCheckinSortScoreThreshold=a.sortScore}},{key:"stackSize",get:function(){return this._stack.size}},{key:"checkinsDataSize",get:function(){return this._sortedCheckinsData.size}},{key:"newCheckinSortScoreThreshold",get:function(){return this._newCheckinSortScoreThreshold}},{key:"checkinsDataSortFunctions",get:function(){var t=[];return t.push((function(t){return-1*t.sortScore})),t}}],[{key:"normalizeCheckinId",value:function(t){return t.toString()}}]),t})();window.WallState=t})();
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=(function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}})(),_get=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,o)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(o)};!(function(){var t=(function(t){function e(t){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return helpers.autoBind(n),n}return _inherits(e,WallState),_createClass(e,[{key:"updateNewCheckinSortScoreThreshold",value:function(){var t=this.getSortedCheckinsData().last();if(!t)return!1;this._newCheckinSortScoreThreshold=t.sortScore}},{key:"setCheckinData",value:function(t,n){void 0===n.showCount&&(n.showCount=this.getInitialShowCount()),_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setCheckinData",this).call(this,t,n)}},{key:"incrementShowCount",value:function(t){if(t=WallState.normalizeCheckinId(t),this.hasCheckin(t)){var e=this.getCheckinData(t);e.showCount=e.showCount+1,this.setCheckinData(t,e)}}},{key:"getInitialShowCount",value:function(){var t=this.getSortedCheckinsData().map((function(t){return t.showCount})).max()||0;return 0===t?0:t-1}},{key:"checkinsDataSortFunctions",get:function(){var t=[];return t.push((function(t){return-1*t.sortScore})),t.push((function(t){return t.showCount})),t}}]),e})();window.KioskWallState=t})();
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=(function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}})();!(function(){var e=["#cccccc","#444444"],t=$(window),i=$(document),a=$("html"),n=$("body"),s=$(".socialwall_container"),r=helpers.Animation,l=(function(){function l(e){_classCallCheck(this,l),this.defaults={initialCheckins:30,maxCommentLength:220,proxyImageQuality:85,proxyProfileImageHeight:200,proxyProfileImageWidth:200,slideInterval:1e4},e=this.initWallOptions(e),this.wallOptions=e,this.state=new KioskWallState(e),this.checkinsHelper=new helpers.Checkins(e,this.state),this.imageHelper=new helpers.Image(e),this.routeHelper=new helpers.Route(e),this.videoHelper=new helpers.Video(e,helpers.Wall,helpers.Templates),this.wallHelper=new helpers.Wall(e),this.isClientStopped=!1,this.isWallInitialized=!1,this.lastAdvanceAt=0,this.serverTime=null,this.socket=null,this.successiveNonAdShowCount=0,this.isAutoAdvancePaused=!1,helpers.autoBind(this)}return _createClass(l,[{key:"initWallOptions",value:function(e){return e=l.cleanupWallOptions(e),e.clientRankingMode="weight"===e.rankingMode?"weight":"time",_.assign({},this.defaults,e)}},{key:"initSocket",value:function(){var e=this,t=this.wallHelper.getWallSocket();t.on("wallping",(function(t){e.serverTime=t.serverTime})),t.on("connect_error",this.handleSocketConnectError),t.on("looped post",this.handleLoopedPost),t.on("new checkins",this.handleNewCheckins),t.on("removed checkins",this.handleRemovedCheckins),t.on("stop",this.stopClient),t.on("subscribe error",this.handleSocketConnectError),t.on("update checkin data",this.handleUpdatedCheckinData),this.socket=t}},{key:"isNewAdNeededAndPossible",value:function(){return!!this.wallOptions.isAdsEnabled&&(0!==this.wallOptions.ads.length&&(!!this.wallOptions.adsFrequency&&this.successiveNonAdShowCount>=this.wallOptions.adsFrequency))}},{key:"toggleDisplayState",value:function(){var e=$(".checkin").eq(0);if(0!==e.length&&e.data("has-multiple-display-states")){var t="one"===e.attr("data-display-state")?"both":"one";e.attr("data-display-state",t),l.updateElementSizesAndPositions(),this.lastAdvanceAt=Date.now()}}},{key:"setAutoAdvancePaused",value:function(e){this.isAutoAdvancePaused=e,a.toggleClass("autoadvance-paused",e)}},{key:"prepareComment",value:function(e){var t=this.wallOptions.maxCommentLength;return helpers.Checkins.prepareComment(e,t)}},{key:"prepareCheckin",value:function(e){return e.isPrepared?e:(e=this.checkinsHelper.prepareRankingData(e),e=this.imageHelper.prepareImages(e),e=this.wallHelper.prepareEntities(e),e=this.prepareComment(e),e.isPrepared=!0,e)}},{key:"preloadImagesOfNextCheckins",value:function(){var e=0+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1);this.state.getSortedCheckinsData().slice(0,e).forEach(helpers.Image.preloadImages)}},{key:"generateCheckinElement",value:function(e){var t=this.imageHelper.getAspectRatio(e,"post_image",{defaultPostImageAspectRatio:1,maxPostImageAspectRatio:2,minPostImageAspectRatio:.75}),i=e.post_image?"one":"both",a=l.generateUserElement(e),n=[],s=helpers.Video.hasRealVideo(e),r=this.videoHelper.hasEmbeddedVideoSupport(e),o=!s&&r,h=s||r;return o&&n.push("checkin-with-embedded-video"),e.is_highlighted&&n.push("checkin-highlighted"),helpers.Templates.build("checkin",{comment:e.truncated_html_comment,externalCreatedTimestamp:e.external_created_timestamp,extraCheckinClasses:n,hasMultipleDisplayStates:l.hasMultipleDisplayStates(e),id:e.id,image:e.post_image,imageAspectRatio:t,initialDisplayState:i,postLink:e.post_link,showPlayButton:h,type:e.type,user:a,userId:e.external_user_id})}},{key:"isAllowedAsNewCheckin",value:function(e){var t=this.wallOptions.initialCheckins;return!(this.state.checkinsDataSize>=t)||!(e.sortScore<this.state.newCheckinSortScoreThreshold)}},{key:"showNextCheckin",value:function(){var e=this,t=void 0;if(this.isNewAdNeededAndPossible()){var i=_.sample(this.wallOptions.ads);t=this.checkinsHelper.createCheckinDataFromAd(i)}else t=this.state.getSortedCheckinsData().first();if(t){"sponsored"===t.type?this.successiveNonAdShowCount=0:this.successiveNonAdShowCount++,this.state.incrementShowCount(t.id),l.showNextGradient(t);var a=$(this.generateCheckinElement(t));s.prepend(a),l.resizeMessageText(a),helpers.Wall.updateTimestamps(this.serverTime,t.id),helpers.Video.initVideo(t,a),l.updateElementSizesAndPositions();var n=s.find(".checkin").eq(1);(new r).do((function(){n.find(".big-checkin-type").addClass("big-checkin-type-hidden"),n.addClass("checkin-hidden"),helpers.Video.hasRealVideo(t)?e.videoHelper.displayVideo(a):e.videoHelper.hasEmbeddedVideoSupport(t)&&e.injectVideoEmbed(a)})).wait(500).do((function(){a.removeClass("checkin-before-show"),a.find(".big-checkin-type").removeClass("big-checkin-type-hidden")})).wait(500).do((function(){n.remove()})).run(),this.lastAdvanceAt=Date.now(),this.preloadImagesOfNextCheckins(2)}}},{key:"truncateCheckinData",value:function(){var e=this.wallOptions.initialCheckins;this.state.truncateCheckinData(e)}},{key:"loadCachedCheckins",value:function(){var e=this;this.wallHelper.loadCachedCheckins().then((function(t){t&&e.handleNewCheckins(t)}))}},{key:"prioritizeCheckin",value:function(e){e=this.checkinsHelper.makeCheckinTopRanked(e),this.state.setCheckinData(e.id,e)}},{key:"handleDetailCheckinHash",value:function(){var e=this;if(!this.wallOptions.detailCheckinHash)return Promise.resolve();var t=helpers.slug.toId(this.wallOptions.detailCheckinHash),i=this.state.getCheckinData(t);return i?(this.prioritizeCheckin(i),Promise.resolve()):new Promise(function(i){e.socket.emit("get single checkin",t,(function(t){return t&&t.id?(t=e.prepareCheckin(t),e.prioritizeCheckin(t),i()):i()}))})}},{key:"setCheckinData",value:function(e,t){this.state.isCheckinsDataEmpty()&&helpers.Wall.hideWallInfo(),this.state.setCheckinData(e,t)}},{key:"handleNewCheckins",value:function(e){var t=this;if(_.each(e,(function(e){t.state.hasCheckin(e.id)||t.isAllowedAsNewCheckin(e)&&(e=t.prepareCheckin(e),t.setCheckinData(e.id,e))})),this.truncateCheckinData(),!this.isWallInitialized){if(0===e.length){var i=helpers.translation.__("NO_POSTS_FOUND");return void helpers.Wall.showWallInfo(i)}this.handleDetailCheckinHash().then((function(){t.showNextCheckin(),t.setWallInitialized()}))}}},{key:"handleLoopedPost",value:function(e){e&&(this.state.hasCheckin(e.id)||((e=this.checkinsHelper.makeCheckinTopRanked(e)).isLooped=!0,e=this.prepareCheckin(e),this.setCheckinData(e.id,e),this.truncateCheckinData()))}},{key:"handleRemovedCheckins",value:function(e){this.state.removeCheckinData(e)}},{key:"handleUpdatedCheckinData",value:function(e){if(e.id){var t=e.id;if(this.state.hasCheckin(t)){var i=this.state.getCheckinData(t),a=this.prepareCheckin(i),n=this.prepareCheckin(e),s=_.assign(a,n);this.setCheckinData(t,s)}else this.isAllowedAsNewCheckin(e)&&this.handleNewCheckins([e])}}},{key:"handleSocketConnectError",value:function(){this.state.isCheckinsDataEmpty()&&this.loadCachedCheckins()}},{key:"stopClient",value:function(){this.stopClient=!0,this.socket.disconnect()}},{key:"getSlideDuration",value:function(e){var t=this.wallOptions.slideInterval,i=3*t,a=e.find("video");if(0===a.length)return t;var n=a.get(0).duration;if(!n)return t;var s=Math.round(1e3*n);return s<t?t:s>i?i:s}},{key:"checkAutoAdvance",value:function(){if(this.isWallInitialized&&!this.isAutoAdvancePaused&&"hidden"!==document.visibilityState){var e=$(".checkin").eq(0);if(0!==e.length){var t=e.data("has-multiple-display-states"),i=this.getSlideDuration(e),a=void 0;a=t?i/2:i,Date.now()>this.lastAdvanceAt+a&&this.advance()}}}},{key:"advance",value:function(){if(this.isWallInitialized){var e=$(".checkin").eq(0),t=e.attr("data-display-state");e.data("has-multiple-display-states")&&"one"===t?this.toggleDisplayState():this.showNextCheckin(),this.lastAdvanceAt=Date.now()}}},{key:"injectVideoEmbed",value:function(e){var t=e.data("id"),i=e.data("type"),a=this.state.getCheckinData(t);if(a){var n=a.post_id,s="embeds/"+i+"_embed",r=helpers.Templates.build(s,{mute:!0,token:n});e.find(".video-play-button").replaceWith(r)}}},{key:"setWallInitialized",value:function(){this.isWallInitialized=!0,helpers.Tracking.trackGaTiming("wallinit","Wall","init"),i.trigger("wall.init"),n.removeClass("wall-loading"),a.removeClass("wall-loading"),a.addClass("wall-initialized"),setTimeout((function(){$(".loading-indicator").remove()}),500)}},{key:"initDomEvents",value:function(){var e=this,a=this,r=helpers.$actionElement;i.on("keyup",(function(t){32===t.which&&e.advance()})),t.on("resize",_.throttle((function(){l.updateElementSizesAndPositions()}),50)),s.on("click",".video-play-button",(function(){var e=$(this).closest(".checkin");if(e.hasClass("checkin-with-embedded-video"))return a.injectVideoEmbed(e),!1})),r("pause-autoadvance").on("click",(function(){e.setAutoAdvancePaused(!0)})),r("unpause-autoadvance").on("click",(function(){e.setAutoAdvancePaused(!1)})),helpers.Wall.isMobile()&&!helpers.Wall.isIframe()&&WallsioFullscreen.isSupported()&&n.one("click",WallsioFullscreen.enter),t.on("message",(function(e){if("https://player.vimeo.com"===e.originalEvent.origin){var t=void 0;try{t=JSON.parse(e.originalEvent.data)}catch(e){}if("ready"===_.get(t,"event")){var i=$(".checkin").eq(0);"vimeo"===i.data("type")&&helpers.Video.muteVimeoEmbed(i)}}}))}},{key:"init",value:function(){l.showInitialGradient(),this.initDomEvents(),this.initSocket(),this.wallHelper.generateInstructions(),helpers.Wall.loopInstructions(),helpers.translation.translateText(),this.videoHelper.initEventListeners(),this.wallHelper.initUser(),helpers.Wall.initClipboard(),helpers.sharing.initSharingLinks(),this.routeHelper.clearUrl(!0);this.checkAutoAdvanceIntervalId=setInterval(this.checkAutoAdvance,1e3),$((function(){helpers.Tracking.trackGaTiming("domready","Wall","domready")}))}}],[{key:"cleanupWallOptions",value:function(e){var t=["initialCheckins","maxCommentLength","slideInterval"],i=!0,a=!1,n=void 0;try{for(var s,r=t[Symbol.iterator]();!(i=(s=r.next()).done);i=!0){var l=s.value,o=e[l];(null===o||isNaN(o)||0===parseInt(o,10))&&delete e[l]}}catch(e){a=!0,n=e}finally{try{!i&&r.return&&r.return()}finally{if(a)throw n}}return e}},{key:"updateImageOverlayOpacity",value:function(e,t){var i=e.find(".checkin-image-overlay");if(0!==i.length){var a=void 0;a=t<=0?0:t>=70?.9:.9*(t/70),i.css("opacity",a)}}},{key:"updatePostImageSizeLandscape",value:function(e){var t=e.closest(".checkin-image-wrapper"),i=t.height(),a=e.data("aspect-ratio")||1,n=e.width(),s=n/a,r=void 0;s<=i?(r=n,e.css("height",Math.round(s))):(r=i*a,e.css("width",Math.round(r)),e.css("height",Math.round(i))),"both"===t.closest(".checkin").attr("data-display-state")&&t.css("width",Math.round(r))}},{key:"updatePostImageSizePortrait",value:function(e){var t=e.closest(".checkin-image-wrapper"),i=t.width(),a=e.data("aspect-ratio")||1,n=e.height(),s=n*a,r=void 0;s<=i?(r=n,e.css("width",Math.round(s))):(r=i/a,e.css("height",Math.round(r)),e.css("width",Math.round(i))),"both"===t.closest(".checkin").attr("data-display-state")&&t.css("height",Math.round(r))}},{key:"updatePostImageSize",value:function(){var e=$(".checkin-image").eq(0);if(0!==e.length){var t=e.closest(".checkin-image-wrapper");t.css("width",""),t.css("height",""),e.css("width",""),e.css("height",""),helpers.Wall.isLandscape()?l.updatePostImageSizeLandscape(e):l.updatePostImageSizePortrait(e)}}},{key:"updatePostImagePosition",value:function(){var e=$(".checkin-image").eq(0);if(0!==e.length){e.css("left",""),e.css("top","");var t=e.closest(".checkin-image-wrapper").width()-e.width();if(t>0){var i=t/2;e.css("left",i)}if(helpers.Wall.isPortrait()){var a=e.closest(".checkin-image-wrapper").height()-e.height();if(a>0){var n=a/2;e.css("top",n)}}}}},{key:"updatePostImageTransform",value:function(){var e=$(".checkin").eq(0);if(0!==e.length&&"both"===e.attr("data-display-state")){var i=e.find(".checkin-image-wrapper"),a=e.find(".checkin-image");if(0!==a.length){var n=void 0,s=void 0;if(helpers.Wall.isLandscape()){var r=a.width(),o=$(".checkin-image-measure").width();n=.4*t.width(),s=helpers.Css.getTransformAngle(r,n,o),a.css({"-webkit-transform":"rotateY("+s+"deg)",transform:"rotateY("+s+"deg)"})}else{var h=a.height(),c=$(".checkin-image-measure").height();n=.4*t.height(),s=helpers.Css.getTransformAngle(h,n,c),a.css({"-webkit-transform":"rotateX(-"+s+"deg)",transform:"rotateX(-"+s+"deg)"})}i.css({"-webkit-perspective":n,perspective:n}),l.updateImageOverlayOpacity(a,s)}}}},{key:"updateElementSizesAndPositions",value:function(){l.updatePostImageSize(),l.updatePostImagePosition(),l.updatePostImageTransform()}},{key:"transformGradientColor",value:function(e){var t=tinycolor(e).saturate(3);return t.getBrightness()>90?t=t.darken(10):t.getBrightness()<30&&(t=t.lighten(15)),t.toHexString()}},{key:"resizeMessageText",value:function(e){var t=e.find(".checkin-message"),i=t.text().trim().length,a=Math.round(1.6-.004*i),n=_.clamp(a,.4,1.6);t.css("font-size",n+"em")}},{key:"hasMultipleDisplayStates",value:function(e){if(e.post_image){if(e.comment)return!0;if(e.external_name||e.external_fullname)return!0}return!1}},{key:"generateUserElement",value:function(e){var t=helpers.checkins.getShortName(e),i=helpers.checkins.getFullName(e),a=helpers.checkins.getCombinedName(e),n=t!==i,s=helpers.Templates.build("user_name_parts",{shortName:t,fullName:i,combinedName:a,hasSeparateNames:n});return helpers.Templates.build("user",{type:e.type,shortName:t,fullName:i,combinedName:a,nameParts:s,userId:e.external_user_id,userLink:e.external_user_link,image:e.external_image,externalCreatedTimestamp:e.external_created_timestamp,postId:e.post_id,postLink:e.post_link})}},{key:"getNetworkGradient",value:function(t){var i={facebook:["#306199","#18304b"],flickr:["#ff0084","#99004f"],googleplus:["#dd4b39","#96271a"],instagram:["#e1306c","#951641"],linkedin:["#0077b5","#00344f"],messenger:["#288ef7","#075bb2"],pinterest:["#bd081c","#5b040e"],reddit:["#ff4500","#992900"],rss:["#ffa500","#996300"],tumblr:["#35465c","#10151b"],twitter:["#26c4f1","#0b84a6"],vimeo:["#1ab7ea","#0d7091"],vkontakte:["#4d75a3","#2c435e"],youtube:["#e62117","#89140e"]};return i[t]?i[t]:e}},{key:"getGradientForCheckin",value:function(t){if(!t.post_image)return l.getNetworkGradient(t.type);var i=helpers.Image.getTwoDominantColors(t);return i?[l.transformGradientColor(i[0]),l.transformGradientColor(i[1])]:e}},{key:"showGradient",value:function(e){var t=e[0]+" 0%, "+e[1]+" 100%",i=$("<div>").addClass("gradient-bg");i.css({"background-image":'url("/img/noise.png"), linear-gradient(135deg, '+t+")"}),$(".gradient-container").prepend(i);var a=$(".gradient-bg").eq(1);a.addClass("gradient-bg-hidden"),r.callAfter((function(){return a.remove()}),600)}},{key:"showNextGradient",value:function(e){var t=l.getGradientForCheckin(e);l.showGradient(t)}},{key:"showInitialGradient",value:function(){l.showGradient(e)}}]),l})();window.Wall={create:function(e){window.Wall=new l(e),window.Wall.init()}}})();